/******************************************************************************
 *
 *   Copyright (C) Rota Teknik 2019 All Rights Reserved. Confidential
 *
 **************************************************************************//**
 * @file        sha1.h
 * @brief       SHA Encryption header file.
 *
 * @author      LeventK
 * @date        2017-09-26
 *
 * @ingroup     vts
 * @{
 *****************************************************************************/

/*============================================================================*/
/* Includes                                                                   */
/*============================================================================*/

#ifndef SHA1_H_
#define SHA1_H_


/*============================================================================*/
/* Forward declarations                                                       */
/*============================================================================*/

/*============================================================================*/
/* Constants and macros                                                       */
/*============================================================================*/

// Signed variables are for wimps
#define uchar unsigned char
#define uint unsigned int

/*============================================================================*/
/* Type definitions                                                           */
/*============================================================================*/

/*============================================================================*/
/* Global data                                                                */
/*============================================================================*/

/*============================================================================*/
/* Module global data                                                         */
/*============================================================================*/

/*============================================================================*/
/* Implementation of functions                                                */
/*============================================================================*/

typedef struct {
   uchar data[64];
   uint datalen;
   uint bitlen[2];
   uint state[5];
   uint k[4];
} SHA1_CTX;

/**
 * @brief Initialize sha hashing
 * 
 * @param ctx 
 */
void sha1_init(SHA1_CTX *ctx);

/**
 * @brief udate sha hashing
 * 
 * @param ctx 
 * @param data 
 * @param len 
 */
void sha1_update(SHA1_CTX *ctx, uchar data[], uint len);

/**
 * @brief Finalize hashing algorithm
 * 
 * @param ctx 
 * @param hash 
 */
void sha1_final(SHA1_CTX *ctx, uchar hash[]);

#endif /* SHA1_H_ */
/**@}*/
/******************************************************************************/
/*   Copyright (C) Rota Teknik 2019,  All Rights Reserved. Confidential.      */
/******************************************************************************/